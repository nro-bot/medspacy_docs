
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nrobot.dev/medspacy_docs/reference/medspacy/context/context/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../context_graph/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>medspacy.context.context - Medspacy autogenerated docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#medspacy.context.context" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Medspacy autogenerated docs" class="md-header__button md-logo" aria-label="Medspacy autogenerated docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Medspacy autogenerated docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              medspacy.context.context
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Medspacy autogenerated docs" class="md-nav__button md-logo" aria-label="Medspacy autogenerated docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Medspacy autogenerated docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>medspacy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>medspacy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom_tokenizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.custom_tokenizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.ner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sentence_splitting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.sentence_splitting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.util
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.visualization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>common
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>common
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/base_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.base_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/medspacy_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.medspacy_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/regex_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.regex_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_9" id="__nav_2_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>context
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_9">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>context
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    medspacy.context.context
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    medspacy.context.context
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#medspacy.context.context" class="md-nav__link">
    <span class="md-ellipsis">
      context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText" class="md-nav__link">
    <span class="md-ellipsis">
      ConText
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConText">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.categories" class="md-nav__link">
    <span class="md-ellipsis">
      categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.input_span_type" class="md-nav__link">
    <span class="md-ellipsis">
      input_span_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.rules" class="md-nav__link">
    <span class="md-ellipsis">
      rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.span_group_name" class="md-nav__link">
    <span class="md-ellipsis">
      span_group_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.register_default_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      register_default_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.register_graph_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      register_graph_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.set_context_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_context_attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context_graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context_modifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context_modifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_10" id="__nav_2_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>io
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_10">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/config_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.config_example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/db_connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db_connect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/db_reader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db_reader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/db_writer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db_writer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/doc_consumer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.doc_consumer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../io/pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11" id="__nav_2_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>postprocess
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>postprocess
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postprocess/postprocessing_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessing_functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postprocess/postprocessing_pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessing_pattern
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postprocess/postprocessing_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessing_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../postprocess/postprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_12" >
        
          
          <label class="md-nav__link" for="__nav_2_1_12" id="__nav_2_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>preprocess
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_12">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>preprocess
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.preprocess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocess/preprocessing_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.preprocess.preprocessing_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocess/preprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.preprocess.preprocessor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_13" >
        
          
          <label class="md-nav__link" for="__nav_2_1_13" id="__nav_2_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>section detection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_13">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>section detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section_detection/section/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.section
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section_detection/section_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.section_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section_detection/sectionizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.sectionizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section_detection/util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_14" >
        
          
          <label class="md-nav__link" for="__nav_2_1_14" id="__nav_2_1_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>target matcher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_14">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>target matcher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../target_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../target_matcher/concept_tagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher.concept_tagger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../target_matcher/target_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher.target_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../target_matcher/target_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher.target_rule
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#medspacy.context.context" class="md-nav__link">
    <span class="md-ellipsis">
      context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText" class="md-nav__link">
    <span class="md-ellipsis">
      ConText
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConText">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.categories" class="md-nav__link">
    <span class="md-ellipsis">
      categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.input_span_type" class="md-nav__link">
    <span class="md-ellipsis">
      input_span_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.rules" class="md-nav__link">
    <span class="md-ellipsis">
      rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.span_group_name" class="md-nav__link">
    <span class="md-ellipsis">
      span_group_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.register_default_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      register_default_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.register_graph_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      register_graph_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.context.context.ConText.set_context_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_context_attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>medspacy.context.context</h1>

<div class="doc doc-object doc-module">



<a id="medspacy.context.context"></a>
    <div class="doc doc-contents first">

        <p>The ConText definiton.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="medspacy.context.context.ConText" class="doc doc-heading">
            <code>ConText</code>


</h2>


    <div class="doc doc-contents ">


        <p>The ConText for spaCy processing.</p>
<p>This component matches modifiers in a Doc, defines their scope, and identifies edges between targets and modifiers.
Sets two spaCy extensions:
        - Span.<em>.modifiers: a list of ConTextModifier objects which modify a target Span
        - Doc.</em>.context_graph: a ConText graph object which contains the targets,
            modifiers, and edges between them.</p>






              <details class="quote">
                <summary>Source code in <code>medspacy/context/context.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;medspacy_context&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConText</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ConText for spaCy processing.</span>

<span class="sd">    This component matches modifiers in a Doc, defines their scope, and identifies edges between targets and modifiers.</span>
<span class="sd">    Sets two spaCy extensions:</span>
<span class="sd">            - Span._.modifiers: a list of ConTextModifier objects which modify a target Span</span>
<span class="sd">            - Doc._.context_graph: a ConText graph object which contains the targets,</span>
<span class="sd">                modifiers, and edges between them.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_context&quot;</span><span class="p">,</span>
        <span class="n">rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="n">language_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="n">phrase_matcher_attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;LOWER&quot;</span><span class="p">,</span>
        <span class="n">allowed_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">excluded_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">terminating_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_scope</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_targets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prune_on_modifier_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">prune_on_target_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">span_attrs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="kc">None</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="n">input_span_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;ents&quot;</span><span class="p">,</span>
        <span class="n">span_group_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_spans&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new ConText object.</span>

<span class="sd">        Args:</span>
<span class="sd">            nlp: A SpaCy Language object.</span>
<span class="sd">            name: The name of the component.</span>
<span class="sd">            rules: The rules to load. Default is &quot;default&quot;, loads rules packaged with medspaCy that are derived from</span>
<span class="sd">                original ConText rules and years of practical applications at the US Department of Veterans Affairs.  If</span>
<span class="sd">                None, no rules are loaded. Otherwise, must be a path to a json file containing rules. Add ConTextRules</span>
<span class="sd">                directly through `ConText.add`.</span>
<span class="sd">            language_code: Language code to use (ISO code) as a default for loading resources.  See documentation</span>
<span class="sd">                and also the /resources directory to see which resources might be available in each language.</span>
<span class="sd">                Default is &quot;en&quot; for English.</span>
<span class="sd">            phrase_matcher_attr: The token attribute to use for PhraseMatcher for rules where `pattern` is None. Default</span>
<span class="sd">                is &#39;LOWER&#39;.</span>
<span class="sd">            allowed_types: A global list of types included by context. Rules will operate on only spans with these</span>
<span class="sd">                labels.</span>
<span class="sd">            excluded_types: A global list of types excluded by context. Rules will not operate on spans with these</span>
<span class="sd">                labels.</span>
<span class="sd">            terminating_types: A global map of types to the types that can terminate them. This can be used to apply</span>
<span class="sd">                terminations to all rules of a particular type rather than adding to every rule individually in the</span>
<span class="sd">                ContextRule object.</span>
<span class="sd">            max_scope: The number of tokens around a modifier in a target can be modified. Default value is None,</span>
<span class="sd">                Context will use the sentence boundaries. If a value greater than zero, applies the window globally.</span>
<span class="sd">                Both options will be overridden by a more specific value in a ContextRule.</span>
<span class="sd">            max_targets: The maximum number of targets a modifier can modify. Default value is None, context will modify</span>
<span class="sd">                all targets in its scope. If a value greater than zero, applies this value globally. Both options will</span>
<span class="sd">                be overridden by a more specific value in a ContextRule.</span>
<span class="sd">            prune_on_modifier_overlap: Whether to prune modifiers which are substrings of another modifier. If True,</span>
<span class="sd">                will drop substrings completely. For example, if &quot;no history of&quot;  and &quot;history of&quot; are both</span>
<span class="sd">                ConTextRules,both will match the text &quot;no history of afib&quot;, but only &quot;no  history of&quot; should modify</span>
<span class="sd">                afib. Default True.</span>
<span class="sd">            prune_on_target_overlap: Whether to remove any matched modifiers which overlap with target entities. If</span>
<span class="sd">                False, any overlapping modifiers will not modify the overlapping entity but will still modify any other</span>
<span class="sd">                targets in its scope. Default False.</span>
<span class="sd">            span_attrs: The optional span attributes to modify. Default option &quot;default&quot; uses attributes in</span>
<span class="sd">                `DEFAULT_ATTRIBUTES`. If a dictionary, format is mapping context modifier categories to a dictionary</span>
<span class="sd">                containing the attribute name and the value to set the attribute to when a  span is modified by a</span>
<span class="sd">                modifier of that category. If None, no attributes will be modified.</span>
<span class="sd">            input_span_type: &quot;ents&quot; or &quot;group&quot;. Where to look for targets. &quot;ents&quot; will modify attributes of spans</span>
<span class="sd">                in doc.ents. &quot;group&quot; will modify attributes of spans in the span group specified by `span_group_name`.</span>
<span class="sd">            span_group_name: The name of the span group used when `input_span_type` is &quot;group&quot;. Default is</span>
<span class="sd">                &quot;medspacy_spans&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prune_on_modifier_overlap</span> <span class="o">=</span> <span class="n">prune_on_modifier_overlap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prune_on_target_overlap</span> <span class="o">=</span> <span class="n">prune_on_target_overlap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_span_type</span> <span class="o">=</span> <span class="n">input_span_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span_group_name</span> <span class="o">=</span> <span class="n">span_group_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;resources&quot;</span><span class="p">,</span> <span class="n">language_code</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s2">&quot;context_rules.json&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span> <span class="o">=</span> <span class="n">MedspacyMatcher</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">phrase_matcher_attr</span><span class="o">=</span><span class="n">phrase_matcher_attr</span><span class="p">,</span>
            <span class="n">prune</span><span class="o">=</span><span class="n">prune_on_modifier_overlap</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">span_attrs</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span> <span class="o">=</span> <span class="n">DEFAULT_ATTRIBUTES</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_default_attributes</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">span_attrs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">attr_dict</span> <span class="ow">in</span> <span class="n">span_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Custom extension </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2"> has not been set. Please ensure Span.set_extension is &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;called for your pipeline&#39;s custom extensions.&quot;</span>
                        <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span> <span class="o">=</span> <span class="n">span_attrs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">register_graph_attributes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">max_scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">max_scope</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">max_scope</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;If &#39;max_scope&#39; must be a value greater than 0, not the current value: </span><span class="si">{</span><span class="n">max_scope</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_scope</span> <span class="o">=</span> <span class="n">max_scope</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_types</span> <span class="o">=</span> <span class="n">allowed_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excluded_types</span> <span class="o">=</span> <span class="n">excluded_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_targets</span> <span class="o">=</span> <span class="n">max_targets</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">terminating_types</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span> <span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">terminating_types</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

        <span class="n">rule_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">rules</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="n">rule_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rule_path</span> <span class="o">=</span> <span class="n">rules</span>

        <span class="k">if</span> <span class="n">rule_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ConTextRule</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">rule_path</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of ConTextRules available to context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rules</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">categories</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of categories available that Context might produce.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">input_span_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The input source of entities for the component. Must be either &quot;ents&quot; corresponding to doc.ents or &quot;group&quot; for</span>
<span class="sd">        a spaCy span group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The input type, &quot;ents&quot; or &quot;group&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span>

    <span class="nd">@input_span_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">input_span_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;ents&quot;</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;input_type must be &quot;ents&quot; or &quot;group&quot;.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">span_group_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name of the span group used by this component. If `input_type` is &quot;group&quot;, calling this component will</span>
<span class="sd">        use spans in the span group with this name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The span group name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span>

    <span class="nd">@span_group_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">span_group_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Span group name must be a string.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds ConTextRules to Context.</span>

<span class="sd">        Args:</span>
<span class="sd">            rules: A single ConTextRule or a collection of ConTextRules to add to the Sectionizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">ConTextRule</span><span class="p">):</span>
            <span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rules</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">ConTextRule</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rules must type ConTextRule, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

            <span class="c1"># If global attributes like allowed_types and max_scope are defined,</span>
            <span class="c1"># check if the ConTextRule has them defined. If not, set to the global</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="s2">&quot;allowed_types&quot;</span><span class="p">,</span>
                <span class="s2">&quot;excluded_types&quot;</span><span class="p">,</span>
                <span class="s2">&quot;max_scope&quot;</span><span class="p">,</span>
                <span class="s2">&quot;max_targets&quot;</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># No global value set</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="p">):</span>  <span class="c1"># If the direction itself has it defined, don&#39;t override</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="c1"># Check custom termination points</span>
            <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">other_modifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span><span class="p">[</span><span class="n">rule</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">upper</span><span class="p">()]:</span>
                    <span class="n">rule</span><span class="o">.</span><span class="n">terminated_by</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other_modifier</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_graph_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers spaCy attribute extensions: Span._.modifiers and Doc._.context_graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;modifiers&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(),</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;context_graph&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Extension already set</span>
            <span class="k">pass</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_default_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers the default values for the Span attributes defined in `DEFAULT_ATTRIBUTES`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;is_negated&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_uncertain&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_historical&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_hypothetical&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_family&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Extension already set</span>
                <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_context_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds Span-level attributes to targets with modifiers.</span>

<span class="sd">        Args:</span>
<span class="sd">            edges: The edges of the ContextGraph to modify.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">modifier</span><span class="p">)</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">modifier</span><span class="o">.</span><span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span><span class="p">:</span>
                <span class="n">attr_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span><span class="p">[</span><span class="n">modifier</span><span class="o">.</span><span class="n">category</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the ConText algorithm to a Doc.</span>

<span class="sd">        Args:</span>
<span class="sd">            doc: The spaCy Doc to process.</span>
<span class="sd">            targets: The optional custom attribute extension on doc to run over. Must contain an iterable of Span objects</span>

<span class="sd">        Returns:</span>
<span class="sd">            The processed spaCy Doc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">targets</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_span_type</span> <span class="o">==</span> <span class="s2">&quot;ents&quot;</span><span class="p">:</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">targets</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_span_type</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">span_group_name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">targets</span><span class="p">:</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        <span class="c1"># Store data in ConTextGraph object</span>
        <span class="c1"># TODO: move some of this over to ConTextGraph</span>
        <span class="n">context_graph</span> <span class="o">=</span> <span class="n">ConTextGraph</span><span class="p">(</span>
            <span class="n">prune_on_modifier_overlap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prune_on_target_overlap</span>
        <span class="p">)</span>

        <span class="n">context_graph</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span>

        <span class="n">context_graph</span><span class="o">.</span><span class="n">modifiers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="c1"># Get the ConTextRule object defining this modifier</span>
            <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">match_id</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">]</span>
            <span class="n">modifier</span> <span class="o">=</span> <span class="n">ConTextModifier</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">max_scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_scope</span><span class="p">)</span>
            <span class="n">context_graph</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modifier</span><span class="p">)</span>

        <span class="n">context_graph</span><span class="o">.</span><span class="n">update_scopes</span><span class="p">()</span>
        <span class="n">context_graph</span><span class="o">.</span><span class="n">apply_modifiers</span><span class="p">()</span>

        <span class="c1"># Link targets to their modifiers</span>
        <span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">modifier</span> <span class="ow">in</span> <span class="n">context_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="n">target</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">modifiers</span> <span class="o">+=</span> <span class="p">(</span><span class="n">modifier</span><span class="p">,)</span>

        <span class="c1"># If attributes need to be modified</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_context_attributes</span><span class="p">(</span><span class="n">context_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">context_graph</span> <span class="o">=</span> <span class="n">context_graph</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="medspacy.context.context.ConText.categories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">categories</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns list of categories available that Context might produce.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.context.context.ConText.input_span_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_span_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The input source of entities for the component. Must be either "ents" corresponding to doc.ents or "group" for
a spaCy span group.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input type, "ents" or "group".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.context.context.ConText.rules" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rules</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns list of ConTextRules available to context.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.context.context.ConText.span_group_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">span_group_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The name of the span group used by this component. If <code>input_type</code> is "group", calling this component will
use spans in the span group with this name.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The span group name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="medspacy.context.context.ConText.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Applies the ConText algorithm to a Doc.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spaCy Doc to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>targets</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optional custom attribute extension on doc to run over. Must contain an iterable of Span objects</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="spacy.tokens.Doc">Doc</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The processed spaCy Doc.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/context/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the ConText algorithm to a Doc.</span>

<span class="sd">    Args:</span>
<span class="sd">        doc: The spaCy Doc to process.</span>
<span class="sd">        targets: The optional custom attribute extension on doc to run over. Must contain an iterable of Span objects</span>

<span class="sd">    Returns:</span>
<span class="sd">        The processed spaCy Doc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">targets</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_span_type</span> <span class="o">==</span> <span class="s2">&quot;ents&quot;</span><span class="p">:</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">targets</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_span_type</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">span_group_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">targets</span><span class="p">:</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
    <span class="c1"># Store data in ConTextGraph object</span>
    <span class="c1"># TODO: move some of this over to ConTextGraph</span>
    <span class="n">context_graph</span> <span class="o">=</span> <span class="n">ConTextGraph</span><span class="p">(</span>
        <span class="n">prune_on_modifier_overlap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prune_on_target_overlap</span>
    <span class="p">)</span>

    <span class="n">context_graph</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span>

    <span class="n">context_graph</span><span class="o">.</span><span class="n">modifiers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="c1"># Get the ConTextRule object defining this modifier</span>
        <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">match_id</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">]</span>
        <span class="n">modifier</span> <span class="o">=</span> <span class="n">ConTextModifier</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">max_scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_scope</span><span class="p">)</span>
        <span class="n">context_graph</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">modifier</span><span class="p">)</span>

    <span class="n">context_graph</span><span class="o">.</span><span class="n">update_scopes</span><span class="p">()</span>
    <span class="n">context_graph</span><span class="o">.</span><span class="n">apply_modifiers</span><span class="p">()</span>

    <span class="c1"># Link targets to their modifiers</span>
    <span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">modifier</span> <span class="ow">in</span> <span class="n">context_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
        <span class="n">target</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">modifiers</span> <span class="o">+=</span> <span class="p">(</span><span class="n">modifier</span><span class="p">,)</span>

    <span class="c1"># If attributes need to be modified</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_context_attributes</span><span class="p">(</span><span class="n">context_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">context_graph</span> <span class="o">=</span> <span class="n">context_graph</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.context.context.ConText.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;medspacy_context&#39;</span><span class="p">,</span> <span class="n">rules</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">language_code</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="n">phrase_matcher_attr</span><span class="o">=</span><span class="s1">&#39;LOWER&#39;</span><span class="p">,</span> <span class="n">allowed_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">excluded_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">terminating_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_targets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prune_on_modifier_overlap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prune_on_target_overlap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">span_attrs</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">input_span_type</span><span class="o">=</span><span class="s1">&#39;ents&#39;</span><span class="p">,</span> <span class="n">span_group_name</span><span class="o">=</span><span class="s1">&#39;medspacy_spans&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a new ConText object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nlp</code>
            </td>
            <td>
                  <code><span title="spacy.language.Language">Language</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A SpaCy Language object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the component.</p>
              </div>
            </td>
            <td>
                  <code>&#39;medspacy_context&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rules to load. Default is "default", loads rules packaged with medspaCy that are derived from
original ConText rules and years of practical applications at the US Department of Veterans Affairs.  If
None, no rules are loaded. Otherwise, must be a path to a json file containing rules. Add ConTextRules
directly through <code>ConText.add</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>language_code</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Language code to use (ISO code) as a default for loading resources.  See documentation
and also the /resources directory to see which resources might be available in each language.
Default is "en" for English.</p>
              </div>
            </td>
            <td>
                  <code>&#39;en&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phrase_matcher_attr</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The token attribute to use for PhraseMatcher for rules where <code>pattern</code> is None. Default
is 'LOWER'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;LOWER&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allowed_types</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Set">Set</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A global list of types included by context. Rules will operate on only spans with these
labels.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>excluded_types</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Set">Set</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A global list of types excluded by context. Rules will not operate on spans with these
labels.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>terminating_types</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Iterable">Iterable</span>[str]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A global map of types to the types that can terminate them. This can be used to apply
terminations to all rules of a particular type rather than adding to every rule individually in the
ContextRule object.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_scope</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of tokens around a modifier in a target can be modified. Default value is None,
Context will use the sentence boundaries. If a value greater than zero, applies the window globally.
Both options will be overridden by a more specific value in a ContextRule.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_targets</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of targets a modifier can modify. Default value is None, context will modify
all targets in its scope. If a value greater than zero, applies this value globally. Both options will
be overridden by a more specific value in a ContextRule.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prune_on_modifier_overlap</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to prune modifiers which are substrings of another modifier. If True,
will drop substrings completely. For example, if "no history of"  and "history of" are both
ConTextRules,both will match the text "no history of afib", but only "no  history of" should modify
afib. Default True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prune_on_target_overlap</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to remove any matched modifiers which overlap with target entities. If
False, any overlapping modifiers will not modify the overlapping entity but will still modify any other
targets in its scope. Default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>span_attrs</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Literal">Literal</span>[&#39;default&#39;], <span title="typing.Dict">Dict</span>[str, <span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optional span attributes to modify. Default option "default" uses attributes in
<code>DEFAULT_ATTRIBUTES</code>. If a dictionary, format is mapping context modifier categories to a dictionary
containing the attribute name and the value to set the attribute to when a  span is modified by a
modifier of that category. If None, no attributes will be modified.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_span_type</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Literal">Literal</span>[&#39;ents&#39;, &#39;group&#39;]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"ents" or "group". Where to look for targets. "ents" will modify attributes of spans
in doc.ents. "group" will modify attributes of spans in the span group specified by <code>span_group_name</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;ents&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>span_group_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the span group used when <code>input_span_type</code> is "group". Default is
"medspacy_spans".</p>
              </div>
            </td>
            <td>
                  <code>&#39;medspacy_spans&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/context/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_context&quot;</span><span class="p">,</span>
    <span class="n">rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">language_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
    <span class="n">phrase_matcher_attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;LOWER&quot;</span><span class="p">,</span>
    <span class="n">allowed_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">excluded_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">terminating_types</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_scope</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_targets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prune_on_modifier_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">prune_on_target_overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">span_attrs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="kc">None</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">input_span_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;ents&quot;</span><span class="p">,</span>
    <span class="n">span_group_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_spans&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new ConText object.</span>

<span class="sd">    Args:</span>
<span class="sd">        nlp: A SpaCy Language object.</span>
<span class="sd">        name: The name of the component.</span>
<span class="sd">        rules: The rules to load. Default is &quot;default&quot;, loads rules packaged with medspaCy that are derived from</span>
<span class="sd">            original ConText rules and years of practical applications at the US Department of Veterans Affairs.  If</span>
<span class="sd">            None, no rules are loaded. Otherwise, must be a path to a json file containing rules. Add ConTextRules</span>
<span class="sd">            directly through `ConText.add`.</span>
<span class="sd">        language_code: Language code to use (ISO code) as a default for loading resources.  See documentation</span>
<span class="sd">            and also the /resources directory to see which resources might be available in each language.</span>
<span class="sd">            Default is &quot;en&quot; for English.</span>
<span class="sd">        phrase_matcher_attr: The token attribute to use for PhraseMatcher for rules where `pattern` is None. Default</span>
<span class="sd">            is &#39;LOWER&#39;.</span>
<span class="sd">        allowed_types: A global list of types included by context. Rules will operate on only spans with these</span>
<span class="sd">            labels.</span>
<span class="sd">        excluded_types: A global list of types excluded by context. Rules will not operate on spans with these</span>
<span class="sd">            labels.</span>
<span class="sd">        terminating_types: A global map of types to the types that can terminate them. This can be used to apply</span>
<span class="sd">            terminations to all rules of a particular type rather than adding to every rule individually in the</span>
<span class="sd">            ContextRule object.</span>
<span class="sd">        max_scope: The number of tokens around a modifier in a target can be modified. Default value is None,</span>
<span class="sd">            Context will use the sentence boundaries. If a value greater than zero, applies the window globally.</span>
<span class="sd">            Both options will be overridden by a more specific value in a ContextRule.</span>
<span class="sd">        max_targets: The maximum number of targets a modifier can modify. Default value is None, context will modify</span>
<span class="sd">            all targets in its scope. If a value greater than zero, applies this value globally. Both options will</span>
<span class="sd">            be overridden by a more specific value in a ContextRule.</span>
<span class="sd">        prune_on_modifier_overlap: Whether to prune modifiers which are substrings of another modifier. If True,</span>
<span class="sd">            will drop substrings completely. For example, if &quot;no history of&quot;  and &quot;history of&quot; are both</span>
<span class="sd">            ConTextRules,both will match the text &quot;no history of afib&quot;, but only &quot;no  history of&quot; should modify</span>
<span class="sd">            afib. Default True.</span>
<span class="sd">        prune_on_target_overlap: Whether to remove any matched modifiers which overlap with target entities. If</span>
<span class="sd">            False, any overlapping modifiers will not modify the overlapping entity but will still modify any other</span>
<span class="sd">            targets in its scope. Default False.</span>
<span class="sd">        span_attrs: The optional span attributes to modify. Default option &quot;default&quot; uses attributes in</span>
<span class="sd">            `DEFAULT_ATTRIBUTES`. If a dictionary, format is mapping context modifier categories to a dictionary</span>
<span class="sd">            containing the attribute name and the value to set the attribute to when a  span is modified by a</span>
<span class="sd">            modifier of that category. If None, no attributes will be modified.</span>
<span class="sd">        input_span_type: &quot;ents&quot; or &quot;group&quot;. Where to look for targets. &quot;ents&quot; will modify attributes of spans</span>
<span class="sd">            in doc.ents. &quot;group&quot; will modify attributes of spans in the span group specified by `span_group_name`.</span>
<span class="sd">        span_group_name: The name of the span group used when `input_span_type` is &quot;group&quot;. Default is</span>
<span class="sd">            &quot;medspacy_spans&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prune_on_modifier_overlap</span> <span class="o">=</span> <span class="n">prune_on_modifier_overlap</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prune_on_target_overlap</span> <span class="o">=</span> <span class="n">prune_on_target_overlap</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_span_type</span> <span class="o">=</span> <span class="n">input_span_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">span_group_name</span> <span class="o">=</span> <span class="n">span_group_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;resources&quot;</span><span class="p">,</span> <span class="n">language_code</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s2">&quot;context_rules.json&quot;</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span> <span class="o">=</span> <span class="n">MedspacyMatcher</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">phrase_matcher_attr</span><span class="o">=</span><span class="n">phrase_matcher_attr</span><span class="p">,</span>
        <span class="n">prune</span><span class="o">=</span><span class="n">prune_on_modifier_overlap</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">span_attrs</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span> <span class="o">=</span> <span class="n">DEFAULT_ATTRIBUTES</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_default_attributes</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">span_attrs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">attr_dict</span> <span class="ow">in</span> <span class="n">span_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Custom extension </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2"> has not been set. Please ensure Span.set_extension is &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;called for your pipeline&#39;s custom extensions.&quot;</span>
                    <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span> <span class="o">=</span> <span class="n">span_attrs</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">register_graph_attributes</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">max_scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">max_scope</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">max_scope</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;If &#39;max_scope&#39; must be a value greater than 0, not the current value: </span><span class="si">{</span><span class="n">max_scope</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_scope</span> <span class="o">=</span> <span class="n">max_scope</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">allowed_types</span> <span class="o">=</span> <span class="n">allowed_types</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">excluded_types</span> <span class="o">=</span> <span class="n">excluded_types</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_targets</span> <span class="o">=</span> <span class="n">max_targets</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">terminating_types</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span> <span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">terminating_types</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="n">rule_path</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">rules</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="n">rule_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rule_path</span> <span class="o">=</span> <span class="n">rules</span>

    <span class="k">if</span> <span class="n">rule_path</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ConTextRule</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">rule_path</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.context.context.ConText.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds ConTextRules to Context.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single ConTextRule or a collection of ConTextRules to add to the Sectionizer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/context/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds ConTextRules to Context.</span>

<span class="sd">    Args:</span>
<span class="sd">        rules: A single ConTextRule or a collection of ConTextRules to add to the Sectionizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">ConTextRule</span><span class="p">):</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rules</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">ConTextRule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rules must type ConTextRule, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="c1"># If global attributes like allowed_types and max_scope are defined,</span>
        <span class="c1"># check if the ConTextRule has them defined. If not, set to the global</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="s2">&quot;allowed_types&quot;</span><span class="p">,</span>
            <span class="s2">&quot;excluded_types&quot;</span><span class="p">,</span>
            <span class="s2">&quot;max_scope&quot;</span><span class="p">,</span>
            <span class="s2">&quot;max_targets&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># No global value set</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">):</span>  <span class="c1"># If the direction itself has it defined, don&#39;t override</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Check custom termination points</span>
        <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">other_modifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminating_types</span><span class="p">[</span><span class="n">rule</span><span class="o">.</span><span class="n">category</span><span class="o">.</span><span class="n">upper</span><span class="p">()]:</span>
                <span class="n">rule</span><span class="o">.</span><span class="n">terminated_by</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other_modifier</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.context.context.ConText.register_default_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_default_attributes</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Registers the default values for the Span attributes defined in <code>DEFAULT_ATTRIBUTES</code>.</p>

            <details class="quote">
              <summary>Source code in <code>medspacy/context/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_default_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers the default values for the Span attributes defined in `DEFAULT_ATTRIBUTES`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;is_negated&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_uncertain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_historical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_hypothetical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_family&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Extension already set</span>
            <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.context.context.ConText.register_graph_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_graph_attributes</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Registers spaCy attribute extensions: Span.<em>.modifiers and Doc.</em>.context_graph.</p>

            <details class="quote">
              <summary>Source code in <code>medspacy/context/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_graph_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers spaCy attribute extensions: Span._.modifiers and Doc._.context_graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;modifiers&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(),</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;context_graph&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Extension already set</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.context.context.ConText.set_context_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_context_attributes</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds Span-level attributes to targets with modifiers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The edges of the ContextGraph to modify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/context/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_context_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds Span-level attributes to targets with modifiers.</span>

<span class="sd">    Args:</span>
<span class="sd">        edges: The edges of the ContextGraph to modify.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">modifier</span><span class="p">)</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">modifier</span><span class="o">.</span><span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span><span class="p">:</span>
            <span class="n">attr_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_attributes_mapping</span><span class="p">[</span><span class="n">modifier</span><span class="o">.</span><span class="n">category</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>