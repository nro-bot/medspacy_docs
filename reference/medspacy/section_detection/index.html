
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nrobot.dev/medspacy_docs/reference/medspacy/section_detection/">
      
      
        <link rel="prev" href="../preprocess/preprocessor/">
      
      
        <link rel="next" href="section/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>medspacy.section_detection - Medspacy autogenerated docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#medspacy.section_detection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Medspacy autogenerated docs" class="md-header__button md-logo" aria-label="Medspacy autogenerated docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Medspacy autogenerated docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              medspacy.section_detection
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Medspacy autogenerated docs" class="md-nav__button md-logo" aria-label="Medspacy autogenerated docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Medspacy autogenerated docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>medspacy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>medspacy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_tokenizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.custom_tokenizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.ner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sentence_splitting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.sentence_splitting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.util
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.visualization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>common
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>common
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/base_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.base_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/medspacy_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.medspacy_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/regex_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.regex_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.common.util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_9" >
        
          
          <label class="md-nav__link" for="__nav_2_1_9" id="__nav_2_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>context
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_9">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>context
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/context_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context_graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/context_modifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context_modifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/context_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.context_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.context.util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_10" >
        
          
          <label class="md-nav__link" for="__nav_2_1_10" id="__nav_2_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>io
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_10">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/config_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.config_example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/db_connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db_connect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/db_reader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db_reader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/db_writer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.db_writer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/doc_consumer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.doc_consumer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.io.pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_11" >
        
          
          <label class="md-nav__link" for="__nav_2_1_11" id="__nav_2_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>postprocess
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_11">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>postprocess
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postprocess/postprocessing_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessing_functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postprocess/postprocessing_pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessing_pattern
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postprocess/postprocessing_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessing_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postprocess/postprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.postprocess.postprocessor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_12" >
        
          
          <label class="md-nav__link" for="__nav_2_1_12" id="__nav_2_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>preprocess
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_12">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>preprocess
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.preprocess
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocess/preprocessing_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.preprocess.preprocessing_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocess/preprocessor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.preprocess.preprocessor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_13" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_13" id="__nav_2_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>section detection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_13">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>section detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    medspacy.section_detection
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection" class="md-nav__link">
    <span class="md-ellipsis">
      section_detection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section" class="md-nav__link">
    <span class="md-ellipsis">
      Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.body_span" class="md-nav__link">
    <span class="md-ellipsis">
      body_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.section_span" class="md-nav__link">
    <span class="md-ellipsis">
      section_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.title_span" class="md-nav__link">
    <span class="md-ellipsis">
      title_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.from_serialized_representation" class="md-nav__link">
    <span class="md-ellipsis">
      from_serialized_representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.serialized_representation" class="md-nav__link">
    <span class="md-ellipsis">
      serialized_representation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule" class="md-nav__link">
    <span class="md-ellipsis">
      SectionRule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SectionRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.from_json" class="md-nav__link">
    <span class="md-ellipsis">
      from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer" class="md-nav__link">
    <span class="md-ellipsis">
      Sectionizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sectionizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.input_span_type" class="md-nav__link">
    <span class="md-ellipsis">
      input_span_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.rules" class="md-nav__link">
    <span class="md-ellipsis">
      rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.section_categories" class="md-nav__link">
    <span class="md-ellipsis">
      section_categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.span_group_name" class="md-nav__link">
    <span class="md-ellipsis">
      span_group_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.filter_end_lines" class="md-nav__link">
    <span class="md-ellipsis">
      filter_end_lines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.filter_start_lines" class="md-nav__link">
    <span class="md-ellipsis">
      filter_start_lines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.register_default_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      register_default_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.set_assertion_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_assertion_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.set_parent_sections" class="md-nav__link">
    <span class="md-ellipsis">
      set_parent_sections
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="section/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.section
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="section_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.section_rule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sectionizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.sectionizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.section_detection.util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_14" >
        
          
          <label class="md-nav__link" for="__nav_2_1_14" id="__nav_2_1_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>target matcher
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_14">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>target matcher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../target_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../target_matcher/concept_tagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher.concept_tagger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../target_matcher/target_matcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher.target_matcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../target_matcher/target_rule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    medspacy.target_matcher.target_rule
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection" class="md-nav__link">
    <span class="md-ellipsis">
      section_detection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section" class="md-nav__link">
    <span class="md-ellipsis">
      Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.body_span" class="md-nav__link">
    <span class="md-ellipsis">
      body_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.section_span" class="md-nav__link">
    <span class="md-ellipsis">
      section_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.title_span" class="md-nav__link">
    <span class="md-ellipsis">
      title_span
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.from_serialized_representation" class="md-nav__link">
    <span class="md-ellipsis">
      from_serialized_representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Section.serialized_representation" class="md-nav__link">
    <span class="md-ellipsis">
      serialized_representation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule" class="md-nav__link">
    <span class="md-ellipsis">
      SectionRule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SectionRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.from_json" class="md-nav__link">
    <span class="md-ellipsis">
      from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.SectionRule.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer" class="md-nav__link">
    <span class="md-ellipsis">
      Sectionizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sectionizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.input_span_type" class="md-nav__link">
    <span class="md-ellipsis">
      input_span_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.rules" class="md-nav__link">
    <span class="md-ellipsis">
      rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.section_categories" class="md-nav__link">
    <span class="md-ellipsis">
      section_categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.span_group_name" class="md-nav__link">
    <span class="md-ellipsis">
      span_group_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.filter_end_lines" class="md-nav__link">
    <span class="md-ellipsis">
      filter_end_lines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.filter_start_lines" class="md-nav__link">
    <span class="md-ellipsis">
      filter_start_lines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.register_default_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      register_default_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.set_assertion_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_assertion_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medspacy.section_detection.Sectionizer.set_parent_sections" class="md-nav__link">
    <span class="md-ellipsis">
      set_parent_sections
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>medspacy.section_detection</h1>

<div class="doc doc-object doc-module">



<a id="medspacy.section_detection"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="medspacy.section_detection.Section" class="doc doc-heading">
            <code>Section</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


        <p>Section is the object that stores the result of processing by the Sectionizer class. A Section contains information
describing the section's category, title span, body span, parent, and the rule that created it.</p>
<p>Section <code>category</code> is equivalent to <code>label_</code> in a basic spaCy entity. It is a normalized name for the section type
determined on initialization, either created manually or through the Sectionizer pipeline component.</p>
<p>Section title, defined with <code>title_start</code>, <code>title_end</code>, and <code>title_span</code> represents the section title or header
matched with the rule. In the text "Past medical history: stroke and high blood pressure", "Past medical history:"
would be the title.</p>
<p>Section body is defined with <code>body_start</code>, <code>body_end</code>, and <code>body_span</code>. It represents the text between the end of
the current section's title and the start of the title for the next Section or when scope is set in the rule or by
the Sectionizer. In the text "Past medical history: stroke and high blood pressure", "stroke and high blood
pressure" would be the body.</p>
<p>Parent is a string that represents the conceptual "parent" section in a section-&gt;subsection-&gt;subsubsection
hierarchy. Candidates are determined by category in the rule and matched at runtime.</p>






              <details class="quote">
                <summary>Source code in <code>medspacy/section_detection/section.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Section</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Section is the object that stores the result of processing by the Sectionizer class. A Section contains information</span>
<span class="sd">    describing the section&#39;s category, title span, body span, parent, and the rule that created it.</span>

<span class="sd">    Section `category` is equivalent to `label_` in a basic spaCy entity. It is a normalized name for the section type</span>
<span class="sd">    determined on initialization, either created manually or through the Sectionizer pipeline component.</span>

<span class="sd">    Section title, defined with `title_start`, `title_end`, and `title_span` represents the section title or header</span>
<span class="sd">    matched with the rule. In the text &quot;Past medical history: stroke and high blood pressure&quot;, &quot;Past medical history:&quot;</span>
<span class="sd">    would be the title.</span>

<span class="sd">    Section body is defined with `body_start`, `body_end`, and `body_span`. It represents the text between the end of</span>
<span class="sd">    the current section&#39;s title and the start of the title for the next Section or when scope is set in the rule or by</span>
<span class="sd">    the Sectionizer. In the text &quot;Past medical history: stroke and high blood pressure&quot;, &quot;stroke and high blood</span>
<span class="sd">    pressure&quot; would be the body.</span>

<span class="sd">    Parent is a string that represents the conceptual &quot;parent&quot; section in a section-&gt;subsection-&gt;subsubsection</span>
<span class="sd">    hierarchy. Candidates are determined by category in the rule and matched at runtime.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">title_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">title_end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">body_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">body_end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">rule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SectionRule</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Section object.</span>

<span class="sd">        Args:</span>
<span class="sd">            category: A normalized name for the section. Equivalent to `label_` for basic spaCy entities.</span>
<span class="sd">            title_start: Index of the first token of the section title.</span>
<span class="sd">            title_end: Index of the last token of the section title.</span>
<span class="sd">            body_start: Index of the first token of the section body.</span>
<span class="sd">            body_end: Index of the last token of the section body.</span>
<span class="sd">            parent: The category of the parent section.</span>
<span class="sd">            rule: The SectionRule that generated the section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_start</span> <span class="o">=</span> <span class="n">title_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_end</span> <span class="o">=</span> <span class="n">title_end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body_start</span> <span class="o">=</span> <span class="n">body_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">body_end</span> <span class="o">=</span> <span class="n">body_end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Section(category=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title_start</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title_end</span><span class="si">}</span><span class="s2"> in the doc with a body at &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">body_start</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">body_end</span><span class="si">}</span><span class="s2"> based on the rule </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rule</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">title_span</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the span of the section title.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple (int,int) containing the start and end indexes of the section title.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_end</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">body_span</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the span of the section body.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple (int,int) containing the start and end indexes of the section body.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_end</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">section_span</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the span of the entire section, from title start to body end.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple (int,int) containing the start index of the section title and the end index of the section body.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_end</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">serialized_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialize the Section.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A json-serialized representation of the section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="s2">&quot;title_start&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_start</span><span class="p">,</span>
            <span class="s2">&quot;title_end&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_end</span><span class="p">,</span>
            <span class="s2">&quot;body_start&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_start</span><span class="p">,</span>
            <span class="s2">&quot;body_end&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_end</span><span class="p">,</span>
            <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
            <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">rule</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="n">rule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_serialized_representation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">serialized_representation</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the section from a json-serialized form.</span>

<span class="sd">        Args:</span>
<span class="sd">            serialized_representation: The dictionary form of the section object to load.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Section object containing the data from the dictionary provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rule</span> <span class="o">=</span> <span class="n">SectionRule</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">serialized_representation</span><span class="p">[</span><span class="s2">&quot;rule&quot;</span><span class="p">])</span>
        <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span>
            <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">serialized_representation</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rule&quot;</span><span class="p">]}</span>
        <span class="p">)</span>
        <span class="n">section</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span>

        <span class="k">return</span> <span class="n">section</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Section.body_span" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">body_span</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the span of the section body.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (int,int) containing the start and end indexes of the section body.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Section.section_span" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">section_span</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the span of the entire section, from title start to body end.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (int,int) containing the start index of the section title and the end index of the section body.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Section.title_span" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">title_span</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the span of the section title.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (int,int) containing the start and end indexes of the section title.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Section.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">title_start</span><span class="p">,</span> <span class="n">title_end</span><span class="p">,</span> <span class="n">body_start</span><span class="p">,</span> <span class="n">body_end</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new Section object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A normalized name for the section. Equivalent to <code>label_</code> for basic spaCy entities.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title_start</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the first token of the section title.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title_end</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the last token of the section title.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>body_start</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the first token of the section body.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>body_end</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the last token of the section body.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The category of the parent section.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rule</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="medspacy.section_detection.section_rule.SectionRule" href="../../../#medspacy.section_detection.section_rule.SectionRule">SectionRule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SectionRule that generated the section.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">title_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">title_end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">body_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">body_end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SectionRule</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new Section object.</span>

<span class="sd">    Args:</span>
<span class="sd">        category: A normalized name for the section. Equivalent to `label_` for basic spaCy entities.</span>
<span class="sd">        title_start: Index of the first token of the section title.</span>
<span class="sd">        title_end: Index of the last token of the section title.</span>
<span class="sd">        body_start: Index of the first token of the section body.</span>
<span class="sd">        body_end: Index of the last token of the section body.</span>
<span class="sd">        parent: The category of the parent section.</span>
<span class="sd">        rule: The SectionRule that generated the section.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">title_start</span> <span class="o">=</span> <span class="n">title_start</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">title_end</span> <span class="o">=</span> <span class="n">title_end</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body_start</span> <span class="o">=</span> <span class="n">body_start</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body_end</span> <span class="o">=</span> <span class="n">body_end</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Section.from_serialized_representation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_serialized_representation</span><span class="p">(</span><span class="n">serialized_representation</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Load the section from a json-serialized form.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>serialized_representation</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary form of the section object to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Section object containing the data from the dictionary provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_serialized_representation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">serialized_representation</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the section from a json-serialized form.</span>

<span class="sd">    Args:</span>
<span class="sd">        serialized_representation: The dictionary form of the section object to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Section object containing the data from the dictionary provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">SectionRule</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">serialized_representation</span><span class="p">[</span><span class="s2">&quot;rule&quot;</span><span class="p">])</span>
    <span class="n">section</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">serialized_representation</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rule&quot;</span><span class="p">]}</span>
    <span class="p">)</span>
    <span class="n">section</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span>

    <span class="k">return</span> <span class="n">section</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Section.serialized_representation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialized_representation</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Serialize the Section.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A json-serialized representation of the section.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialized_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Serialize the Section.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A json-serialized representation of the section.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
        <span class="s2">&quot;title_start&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_start</span><span class="p">,</span>
        <span class="s2">&quot;title_end&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_end</span><span class="p">,</span>
        <span class="s2">&quot;body_start&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_start</span><span class="p">,</span>
        <span class="s2">&quot;body_end&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body_end</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
        <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="n">rule</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="n">rule</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="medspacy.section_detection.SectionRule" class="doc doc-heading">
            <code>SectionRule</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="medspacy.common.base_rule.BaseRule" href="../../../#medspacy.common.base_rule.BaseRule">BaseRule</a></code></p>


        <p>SectionRule defines rules for extracting entities from text using the Sectionizer.</p>






              <details class="quote">
                <summary>Source code in <code>medspacy/section_detection/section_rule.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SectionRule</span><span class="p">(</span><span class="n">BaseRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SectionRule defines rules for extracting entities from text using the Sectionizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ALLOWED_KEYS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;literal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pattern&quot;</span><span class="p">,</span>
        <span class="s2">&quot;category&quot;</span><span class="p">,</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parents&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent_required&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_scope&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">literal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_match</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
            <span class="n">Callable</span><span class="p">[[</span><span class="n">Matcher</span><span class="p">,</span> <span class="n">Doc</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span> <span class="n">Any</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_scope</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parent_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for defining rules for extracting entities from text using TargetMatcher.</span>

<span class="sd">        Args:</span>
<span class="sd">            literal: The string representation of a concept. If `pattern` is None, this string will be lower-cased and</span>
<span class="sd">                matched to the lower-case string. If `pattern` is not None, this argument will not be used for matching</span>
<span class="sd">                but can be used as a reference as the rule name.</span>
<span class="sd">            category: The semantic class of the matched span. This corresponds to the `label_` attribute of an entity.</span>
<span class="sd">            pattern: A list or string to use as a spaCy pattern rather than `literal`. If a list, will use spaCy</span>
<span class="sd">                token-based pattern matching to match using token attributes. If a string, will use medspaCy&#39;s</span>
<span class="sd">                RegexMatcher. If None, will use `literal` as the pattern for phrase matching. For more information, see</span>
<span class="sd">                https://spacy.io/usage/rule-based-matching.</span>
<span class="sd">            on_match: An optional callback function or other callable which takes 4 arguments: `(matcher, doc, i,</span>
<span class="sd">                matches)`. For more information, see https://spacy.io/usage/rule-based-matching#on_match</span>
<span class="sd">            max_scope: A number of tokens to explicitly limit the size of a section body. If None, the scope will</span>
<span class="sd">                include the entire doc up until either the next section header or the end of the doc. This variable can</span>
<span class="sd">                also be set at a global level as `Sectionizer(nlp, max_scope=...), but if the attribute is set here, the</span>
<span class="sd">                rule scope will take precedence. If not None, this will be the number of tokens following the matched</span>
<span class="sd">                section header</span>
<span class="sd">                    Example:</span>
<span class="sd">                        In the text &quot;Past Medical History: Pt has hx of pneumonia&quot;,</span>
<span class="sd">                        SectionRule(&quot;Past Medical History:&quot;, &quot;pmh&quot;, max_scope=None) will include the entire doc, but</span>
<span class="sd">                        SectionRule(&quot;Past Medical History:&quot;, &quot;pmh&quot;, max_scope=2) will limit the section</span>
<span class="sd">                            to be &quot;Past Medical History: Pt has&quot;</span>
<span class="sd">                This can be useful for limiting certain sections which are known to be short or allowing others to be</span>
<span class="sd">                longer than the regular global max_scope.</span>
<span class="sd">            parents: A list of candidate parents for determining subsections</span>
<span class="sd">            parent_required: Whether a parent is required for the section to exist in the final output. If true and no</span>
<span class="sd">                parent is identified, the section will be removed.</span>
<span class="sd">            metadata: Optional dictionary of any extra metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">on_match</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_scope</span> <span class="o">=</span> <span class="n">max_scope</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parents</span> <span class="o">=</span> <span class="n">parents</span>
        <span class="k">if</span> <span class="n">parent_required</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">parents</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Jsonl file incorrectly formatted for pattern name </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;If parents are required, then at least one parent must be specified.&quot;</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent_required</span> <span class="o">=</span> <span class="n">parent_required</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SectionRule</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read in a lexicon of modifiers from a JSON file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filepath: the .json file containing modifier rules</span>

<span class="sd">        Returns:</span>
<span class="sd">            section_rules: a list of SectionRule objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">section_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">section_rules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">section_data</span><span class="p">[</span><span class="s2">&quot;section_rules&quot;</span><span class="p">]:</span>
            <span class="n">section_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SectionRule</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">section_rules</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">rule_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a dictionary into a SectionRule list. Used when reading from a json file.</span>

<span class="sd">        Args:</span>
<span class="sd">            rule_dict: the dictionary to convert</span>

<span class="sd">        Returns:</span>
<span class="sd">            item: the SectionRule created from the dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rule_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">invalid_keys</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_ALLOWED_KEYS</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">invalid_keys</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;JSON object contains invalid keys: </span><span class="si">{</span><span class="n">invalid_keys</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Must be one of: </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">_ALLOWED_KEYS</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">rule</span> <span class="o">=</span> <span class="n">SectionRule</span><span class="p">(</span><span class="o">**</span><span class="n">rule_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rule</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts TargetRules to a python dictionary. Used when writing section rules to a json file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            rule_dict: the dictionary containing the TargetRule info.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rule_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_KEYS</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rule_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">rule_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;SectionRule(literal=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">literal</span><span class="si">}</span><span class="s2">&quot;, category=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;, pattern=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pattern</span><span class="si">}</span><span class="s2">, on_match=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">on_match</span><span class="si">}</span><span class="s2">, parents=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parents</span><span class="si">}</span><span class="s2">, parent_required=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_required</span><span class="si">}</span><span class="s2">)&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.SectionRule.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_match</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Class for defining rules for extracting entities from text using TargetMatcher.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>literal</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string representation of a concept. If <code>pattern</code> is None, this string will be lower-cased and
matched to the lower-case string. If <code>pattern</code> is not None, this argument will not be used for matching
but can be used as a reference as the rule name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The semantic class of the matched span. This corresponds to the <code>label_</code> attribute of an entity.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pattern</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[str, str]], str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list or string to use as a spaCy pattern rather than <code>literal</code>. If a list, will use spaCy
token-based pattern matching to match using token attributes. If a string, will use medspaCy's
RegexMatcher. If None, will use <code>literal</code> as the pattern for phrase matching. For more information, see
https://spacy.io/usage/rule-based-matching.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on_match</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="spacy.matcher.Matcher">Matcher</span>, <span title="spacy.tokens.Doc">Doc</span>, int, <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int]]], <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional callback function or other callable which takes 4 arguments: <code>(matcher, doc, i,
matches)</code>. For more information, see https://spacy.io/usage/rule-based-matching#on_match</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_scope</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A number of tokens to explicitly limit the size of a section body. If None, the scope will
include the entire doc up until either the next section header or the end of the doc. This variable can
also be set at a global level as `Sectionizer(nlp, max_scope=...), but if the attribute is set here, the
rule scope will take precedence. If not None, this will be the number of tokens following the matched
section header
    Example:
        In the text "Past Medical History: Pt has hx of pneumonia",
        SectionRule("Past Medical History:", "pmh", max_scope=None) will include the entire doc, but
        SectionRule("Past Medical History:", "pmh", max_scope=2) will limit the section
            to be "Past Medical History: Pt has"
This can be useful for limiting certain sections which are known to be short or allowing others to be
longer than the regular global max_scope.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parents</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of candidate parents for determining subsections</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent_required</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether a parent is required for the section to exist in the final output. If true and no
parent is identified, the section will be removed.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of any extra metadata.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section_rule.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">literal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_match</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Callable</span><span class="p">[[</span><span class="n">Matcher</span><span class="p">,</span> <span class="n">Doc</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_scope</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parent_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for defining rules for extracting entities from text using TargetMatcher.</span>

<span class="sd">    Args:</span>
<span class="sd">        literal: The string representation of a concept. If `pattern` is None, this string will be lower-cased and</span>
<span class="sd">            matched to the lower-case string. If `pattern` is not None, this argument will not be used for matching</span>
<span class="sd">            but can be used as a reference as the rule name.</span>
<span class="sd">        category: The semantic class of the matched span. This corresponds to the `label_` attribute of an entity.</span>
<span class="sd">        pattern: A list or string to use as a spaCy pattern rather than `literal`. If a list, will use spaCy</span>
<span class="sd">            token-based pattern matching to match using token attributes. If a string, will use medspaCy&#39;s</span>
<span class="sd">            RegexMatcher. If None, will use `literal` as the pattern for phrase matching. For more information, see</span>
<span class="sd">            https://spacy.io/usage/rule-based-matching.</span>
<span class="sd">        on_match: An optional callback function or other callable which takes 4 arguments: `(matcher, doc, i,</span>
<span class="sd">            matches)`. For more information, see https://spacy.io/usage/rule-based-matching#on_match</span>
<span class="sd">        max_scope: A number of tokens to explicitly limit the size of a section body. If None, the scope will</span>
<span class="sd">            include the entire doc up until either the next section header or the end of the doc. This variable can</span>
<span class="sd">            also be set at a global level as `Sectionizer(nlp, max_scope=...), but if the attribute is set here, the</span>
<span class="sd">            rule scope will take precedence. If not None, this will be the number of tokens following the matched</span>
<span class="sd">            section header</span>
<span class="sd">                Example:</span>
<span class="sd">                    In the text &quot;Past Medical History: Pt has hx of pneumonia&quot;,</span>
<span class="sd">                    SectionRule(&quot;Past Medical History:&quot;, &quot;pmh&quot;, max_scope=None) will include the entire doc, but</span>
<span class="sd">                    SectionRule(&quot;Past Medical History:&quot;, &quot;pmh&quot;, max_scope=2) will limit the section</span>
<span class="sd">                        to be &quot;Past Medical History: Pt has&quot;</span>
<span class="sd">            This can be useful for limiting certain sections which are known to be short or allowing others to be</span>
<span class="sd">            longer than the regular global max_scope.</span>
<span class="sd">        parents: A list of candidate parents for determining subsections</span>
<span class="sd">        parent_required: Whether a parent is required for the section to exist in the final output. If true and no</span>
<span class="sd">            parent is identified, the section will be removed.</span>
<span class="sd">        metadata: Optional dictionary of any extra metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">on_match</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_scope</span> <span class="o">=</span> <span class="n">max_scope</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parents</span> <span class="o">=</span> <span class="n">parents</span>
    <span class="k">if</span> <span class="n">parent_required</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parents</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Jsonl file incorrectly formatted for pattern name </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;If parents are required, then at least one parent must be specified.&quot;</span>
            <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent_required</span> <span class="o">=</span> <span class="n">parent_required</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.SectionRule.from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_dict</span><span class="p">(</span><span class="n">rule_dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Reads a dictionary into a SectionRule list. Used when reading from a json file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rule_dict</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the dictionary to convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>item</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the SectionRule created from the dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section_rule.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">rule_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads a dictionary into a SectionRule list. Used when reading from a json file.</span>

<span class="sd">    Args:</span>
<span class="sd">        rule_dict: the dictionary to convert</span>

<span class="sd">    Returns:</span>
<span class="sd">        item: the SectionRule created from the dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rule_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">invalid_keys</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_ALLOWED_KEYS</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">invalid_keys</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;JSON object contains invalid keys: </span><span class="si">{</span><span class="n">invalid_keys</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Must be one of: </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">_ALLOWED_KEYS</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">SectionRule</span><span class="p">(</span><span class="o">**</span><span class="n">rule_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rule</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.SectionRule.from_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_json</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Read in a lexicon of modifiers from a JSON file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the .json file containing modifier rules</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>section_rules</code></td>            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="medspacy.section_detection.section_rule.SectionRule" href="../../../#medspacy.section_detection.section_rule.SectionRule">SectionRule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of SectionRule objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section_rule.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SectionRule</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read in a lexicon of modifiers from a JSON file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filepath: the .json file containing modifier rules</span>

<span class="sd">    Returns:</span>
<span class="sd">        section_rules: a list of SectionRule objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">section_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">section_rules</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">section_data</span><span class="p">[</span><span class="s2">&quot;section_rules&quot;</span><span class="p">]:</span>
        <span class="n">section_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SectionRule</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">section_rules</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.SectionRule.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts TargetRules to a python dictionary. Used when writing section rules to a json file.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rule_dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the dictionary containing the TargetRule info.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/section_rule.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts TargetRules to a python dictionary. Used when writing section rules to a json file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        rule_dict: the dictionary containing the TargetRule info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rule_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_KEYS</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rule_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">rule_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="medspacy.section_detection.Sectionizer" class="doc doc-heading">
            <code>Sectionizer</code>


</h2>


    <div class="doc doc-contents ">


        <p>The Sectionizer will search for spans in the text which match section header rules, such as 'Past Medical History:'.
Sections will be represented in custom attributes as:
    category: A normalized title of the section. Example: 'past_medical_history'
    section_title: The Span of the doc which was matched as a section header.
        Example: 'Past Medical History:'
    section_span: The entire section of the note, starting with section_header and up until the end
        of the section, which will be either the start of the next section header of some pre-specified
        scope. Example: 'Past Medical History: Type II DM'</p>
<p>Section attributes will be registered for each Doc, Span, and Token in the following attributes:
    Doc.<em>.sections: A list of namedtuples of type Section with 4 elements:
        - section_title
        - section_header
        - section_parent
        - section_span.
    A Doc will also have attributes corresponding to lists of each
        (ie., Doc.</em>.section_titles, Doc.<em>.section_headers, Doc.</em>.section_parents, Doc.<em>.section_list)
    (Span|Token).</em>.section_title
    (Span|Token).<em>.section_header
    (Span|Token).</em>.section_parent
    (Span|Token)._.section_span</p>






              <details class="quote">
                <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;medspacy_sectionizer&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Sectionizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Sectionizer will search for spans in the text which match section header rules, such as &#39;Past Medical History:&#39;.</span>
<span class="sd">    Sections will be represented in custom attributes as:</span>
<span class="sd">        category: A normalized title of the section. Example: &#39;past_medical_history&#39;</span>
<span class="sd">        section_title: The Span of the doc which was matched as a section header.</span>
<span class="sd">            Example: &#39;Past Medical History:&#39;</span>
<span class="sd">        section_span: The entire section of the note, starting with section_header and up until the end</span>
<span class="sd">            of the section, which will be either the start of the next section header of some pre-specified</span>
<span class="sd">            scope. Example: &#39;Past Medical History: Type II DM&#39;</span>

<span class="sd">    Section attributes will be registered for each Doc, Span, and Token in the following attributes:</span>
<span class="sd">        Doc._.sections: A list of namedtuples of type Section with 4 elements:</span>
<span class="sd">            - section_title</span>
<span class="sd">            - section_header</span>
<span class="sd">            - section_parent</span>
<span class="sd">            - section_span.</span>
<span class="sd">        A Doc will also have attributes corresponding to lists of each</span>
<span class="sd">            (ie., Doc._.section_titles, Doc._.section_headers, Doc._.section_parents, Doc._.section_list)</span>
<span class="sd">        (Span|Token)._.section_title</span>
<span class="sd">        (Span|Token)._.section_header</span>
<span class="sd">        (Span|Token)._.section_parent</span>
<span class="sd">        (Span|Token)._.section_span</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_sectionizer&quot;</span><span class="p">,</span>
        <span class="n">rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="n">language_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="n">max_section_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">phrase_matcher_attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;LOWER&quot;</span><span class="p">,</span>
        <span class="n">require_start_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">require_end_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">newline_pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[\n\r]+[\s]*$&quot;</span><span class="p">,</span>
        <span class="n">input_span_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ents&quot;</span><span class="p">,</span>
        <span class="n">span_group_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_spans&quot;</span><span class="p">,</span>
        <span class="n">span_attrs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="kc">None</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="n">apply_sentence_boundary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Sectionizer component.</span>

<span class="sd">        Args:</span>
<span class="sd">            nlp: A SpaCy Language object.</span>
<span class="sd">            name: The name of the component.</span>
<span class="sd">            rules: The rules to load. Default is &quot;default&quot;, loads rules packaged with medspaCy that are derived from</span>
<span class="sd">                SecTag, MIMIC-III, and practical refinement at the US Department of Veterans Affairs. If None, no rules</span>
<span class="sd">                are loaded. Otherwise, must be a path to a json file containing rules. Add SectionRules directly through</span>
<span class="sd">                `Sectionizer.add`.</span>
<span class="sd">            language_code: Language code to use (ISO code) as a default for loading resources.  See documentation</span>
<span class="sd">                and also the /resources directory to see which resources might be available in each language.</span>
<span class="sd">                Default is &quot;en&quot; for English.</span>
<span class="sd">            max_section_length: Optional argument specifying the maximum number of tokens following a section header</span>
<span class="sd">                which can be included in a section body. This can be useful if you think your section rules are</span>
<span class="sd">                incomplete and want to prevent sections from running too long in the note. Default is None, meaning that</span>
<span class="sd">                the scope of a section will be until either the next section header or the end of the document.</span>
<span class="sd">            phrase_matcher_attr: The token attribute to use for PhraseMatcher for rules where `pattern` is None. Default</span>
<span class="sd">                is &#39;LOWER&#39;.</span>
<span class="sd">            require_start_line: Optionally require a section header to start on a new line. Default False.</span>
<span class="sd">            require_end_line: Optionally require a section header to end with a new line. Default False.</span>
<span class="sd">            newline_pattern: Regular expression to match the new line either preceding or following a header</span>
<span class="sd">                if either require_start_line or require_end_line are True. Default is r&quot;[\n\r]+[\s]*$&quot;</span>
<span class="sd">            span_attrs: The optional span attributes to modify. Default option &quot;default&quot; uses attributes in</span>
<span class="sd">                `DEFAULT_ATTRIBUTES`. If a dictionary of custom attributes, format is a dictionary mapping section</span>
<span class="sd">                categories to a dictionary containing the attribute name and the value to set the attribute to when a</span>
<span class="sd">                span is contained in a section of that category. Custom attributes must be assigned with</span>
<span class="sd">                `Span.set_extension` before creating the Sectionizer. If None, sectionizer will not modify span</span>
<span class="sd">                attributes.</span>
<span class="sd">            input_span_type: &quot;ents&quot; or &quot;group&quot;. Where to look for spans when modifying attributes of spans</span>
<span class="sd">                contained in a section if `span_attrs` is not None. &quot;ents&quot; will modify attributes of spans in doc.ents.</span>
<span class="sd">                &quot;group&quot; will modify attributes of spans in the span group specified by `span_group_name`.</span>
<span class="sd">            span_group_name: The name of the span group used when `input_span_type` is &quot;group&quot;. Default is</span>
<span class="sd">                &quot;medspacy_spans&quot;.</span>
<span class="sd">            apply_sentence_boundary: Optionally end sentence before and after section header boundary. This ensures</span>
<span class="sd">                the section header is considered its own sentence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span> <span class="o">=</span> <span class="n">max_section_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_start_line</span> <span class="o">=</span> <span class="n">require_start_line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_end_line</span> <span class="o">=</span> <span class="n">require_end_line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newline_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">newline_pattern</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span> <span class="o">=</span> <span class="n">input_span_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span> <span class="o">=</span> <span class="n">span_group_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_sentence_boundary</span> <span class="o">=</span> <span class="n">apply_sentence_boundary</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span> <span class="o">=</span> <span class="n">MedspacyMatcher</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">phrase_matcher_attr</span><span class="o">=</span><span class="n">phrase_matcher_attr</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;resources&quot;</span><span class="p">,</span>
            <span class="n">language_code</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="s2">&quot;section_patterns.json&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">rule_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">rules</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="n">rule_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rule_path</span> <span class="o">=</span> <span class="n">rules</span>

        <span class="k">if</span> <span class="n">rule_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">SectionRule</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">rule_path</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">span_attrs</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span> <span class="o">=</span> <span class="n">DEFAULT_ATTRS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_default_attributes</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">span_attrs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">attr_dict</span> <span class="ow">in</span> <span class="n">span_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Custom extension </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2"> has not been set. Please ensure Span.set_extension is &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;called for your pipeline&#39;s custom extensions.&quot;</span>
                        <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span> <span class="o">=</span> <span class="n">span_attrs</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SectionRule</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets list of rules associated with the Sectionizer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The list of SectionRules associated with the Sectionizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rules</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">section_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets a list of categories used in the Sectionizer.</span>

<span class="sd">        Returns:</span>
<span class="sd">                The list of all section categories available to the Sectionizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">input_span_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The input source of entities for the component. Must be either &quot;ents&quot; corresponding to doc.ents or &quot;group&quot; for</span>
<span class="sd">        a spaCy span group.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The input type, &quot;ents&quot; or &quot;group&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span>

    <span class="nd">@input_span_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">input_span_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;ents&quot;</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;input_type must be &quot;ents&quot; or &quot;group&quot;.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span> <span class="o">=</span> <span class="n">val</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">span_group_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name of the span group used by this component. If `input_type` is &quot;group&quot;, calling this component will</span>
<span class="sd">        use spans in the span group with this name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The span group name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span>

    <span class="nd">@span_group_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">span_group_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Span group name must be a string.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_default_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register the default values for the Span attributes defined in `DEFAULT_ATTRIBUTES`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;is_negated&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_uncertain&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_historical&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_hypothetical&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_family&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Extension already set</span>
                <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds SectionRules to the Sectionizer.</span>

<span class="sd">        Args:</span>
<span class="sd">            rules: A single SectionRule or a collection of SectionRules to add to the Sectionizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">SectionRule</span><span class="p">):</span>
            <span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rules</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">SectionRule</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Rules must be type SectionRule, not&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">rule</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">category</span>
            <span class="n">parents</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">parents</span>
            <span class="n">parent_required</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">parent_required</span>
            <span class="k">if</span> <span class="n">parents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Duplicate section title </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">. Merging parents. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;If this is not intended, please specify distinct titles.&quot;</span><span class="p">,</span>
                        <span class="ne">RuntimeWarning</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">parent_required</span>
            <span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Duplicate section title </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> has different parent_required option. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Setting parent_required to False.&quot;</span><span class="p">,</span>
                    <span class="ne">RuntimeWarning</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_required</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_parent_sections</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the legal parent-child section relationships from the list</span>
<span class="sd">        of in-order sections of a document and the possible parents of each</span>
<span class="sd">        section as specified during direction creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            sections: a list of spacy match tuples found in the doc</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of tuples (match_id, start, end, parent_idx) where the first three indices are the same as the input</span>
<span class="sd">            and the added parent_idx represents the index in the list that corresponds to the parent section. Might be a</span>
<span class="sd">            smaller list than the input due to pruning with `parent_required`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sections_final</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">removed_sections</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sections</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="n">match_id</span><span class="p">]]</span><span class="o">.</span><span class="n">category</span>
            <span class="n">required</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">i_a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">removed_sections</span>  <span class="c1"># adjusted index for removed values</span>
            <span class="k">if</span> <span class="n">required</span> <span class="ow">and</span> <span class="n">i_a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">removed_sections</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">i_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">sections_final</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="n">identified_parent</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                    <span class="c1"># go backwards through the section &quot;tree&quot; until you hit a root or the start of the list</span>
                    <span class="n">candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="n">sections_final</span><span class="p">[</span><span class="n">i_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                    <span class="n">candidates_parent_idx</span> <span class="o">=</span> <span class="n">sections_final</span><span class="p">[</span><span class="n">i_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">candidates_parent_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">candidates_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span>
                                <span class="n">sections_final</span><span class="p">[</span><span class="n">candidates_parent_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                            <span class="p">]</span>
                        <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">candidates_parent</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">candidate_i</span> <span class="o">=</span> <span class="n">i_a</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="k">while</span> <span class="n">candidate</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">candidate</span> <span class="o">==</span> <span class="n">parent</span><span class="p">:</span>
                            <span class="n">identified_parent</span> <span class="o">=</span> <span class="n">candidate_i</span>
                            <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># if you are at the end of the list... no parent</span>
                            <span class="k">if</span> <span class="n">candidate_i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>
                                <span class="k">continue</span>
                            <span class="c1"># if the current candidate has no parent... no parent exists</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">candidates_parent</span><span class="p">:</span>
                                <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>
                                <span class="k">continue</span>
                            <span class="c1"># otherwise get the previous item in the list</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span>
                                    <span class="n">sections_final</span><span class="p">[</span><span class="n">candidate_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                <span class="p">]</span>
                            <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                            <span class="n">temp_parent_idx</span> <span class="o">=</span> <span class="n">sections_final</span><span class="p">[</span><span class="n">candidate_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">temp_parent_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">temp_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span>
                                        <span class="n">sections_final</span><span class="p">[</span><span class="n">temp_parent_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                    <span class="p">]</span>
                                <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">temp_parent</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="c1"># if the previous item is the parent of the current item</span>
                            <span class="c1"># OR if the previous item is a sibling of the current item</span>
                            <span class="c1"># continue to search</span>
                            <span class="k">if</span> <span class="p">(</span>
                                <span class="n">temp</span> <span class="o">==</span> <span class="n">candidates_parent</span>
                                <span class="ow">or</span> <span class="n">temp_parent</span> <span class="o">==</span> <span class="n">candidates_parent</span>
                            <span class="p">):</span>
                                <span class="n">candidate</span> <span class="o">=</span> <span class="n">temp</span>
                                <span class="n">candidates_parent</span> <span class="o">=</span> <span class="n">temp_parent</span>
                                <span class="n">candidate_i</span> <span class="o">-=</span> <span class="mi">1</span>
                            <span class="c1"># otherwise, there is no further tree traversal</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="c1"># if a parent is required, then add</span>
                <span class="k">if</span> <span class="n">identified_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">required</span><span class="p">:</span>
                    <span class="c1"># if the parent is identified, add section</span>
                    <span class="c1"># if the parent is not required, add section</span>
                    <span class="c1"># if parent is not identified and required, do not add the section</span>
                    <span class="n">sections_final</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">identified_parent</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">removed_sections</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">sections_final</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_assertion_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spans</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Span</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add Span-level attributes to entities based on which section they occur in.</span>

<span class="sd">        Args:</span>
<span class="sd">            spans: the spans to modify.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">spans</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span>
                <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span>
            <span class="p">):</span>
                <span class="n">attr_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">category</span><span class="p">]</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call the Sectionizer on a spaCy doc. Sectionizer will identify sections using provided rules, then evaluate any</span>
<span class="sd">        section hierarchy as needed, create section spans, and modify attributes on existing spans based on the sections</span>
<span class="sd">        the entities spans in.</span>

<span class="sd">        Args:</span>
<span class="sd">            doc: The Doc to process.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The processed spaCy Doc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_start_line</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_start_lines</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_end_line</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_end_lines</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_parent_sections</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>

        <span class="c1"># If this has already been processed by the sectionizer, reset the sections</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># if there were no matches, return the doc as one section</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Section</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">doc</span>

        <span class="n">section_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># if the first match does not begin at token 0, handle the first section</span>
        <span class="n">first_match</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">first_match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Section</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">first_match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="c1"># handle section spans</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">matches</span><span class="p">):</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">parent_idx</span><span class="p">)</span> <span class="o">=</span> <span class="n">match</span>
                <span class="k">if</span> <span class="n">parent_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">section_list</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># IDEs will warn here about match shape disagreeing w/ type hinting, but this if is only used if</span>
                <span class="c1"># parent sections were never set, so parent_idx does not exist</span>
                <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="o">=</span> <span class="n">match</span>

            <span class="c1"># Make section header its own sentence</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_sentence_boundary</span><span class="p">:</span>
                <span class="c1"># Section headers should be considered the start of a sentence</span>
                <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># Text following the header should also be considered a new sentence</span>
                <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
                    <span class="n">doc</span><span class="p">[</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="n">match_id</span><span class="p">]]</span>
            <span class="n">category</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">category</span>
            <span class="c1"># If this is the last match, it should include the rest of the doc</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># If there is no scope limitation, go until the end of the doc</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If the rule has a max_scope, use that as a precedence</span>
                    <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

                    <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">scope_end</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="c1"># Otherwise, go until the next section header</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">next_match</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">next_match</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">next_match</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span><span class="p">,</span> <span class="n">next_start</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span><span class="p">,</span> <span class="n">next_start</span><span class="p">)</span>
                    <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">scope_end</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">section_list</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">section_span</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">section</span>

        <span class="c1"># If it is specified to add assertion attributes,</span>
        <span class="c1"># iterate through the entities in doc and add them</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ents&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_assertion_attributes</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_assertion_attributes</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">doc</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_start_lines</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter a list of matches to only contain spans where the start token is the beginning of a new line.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of match tuples (match_id, start, end) that meet the filter criteria.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span> <span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">is_start_line</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">doc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newline_pattern</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_end_lines</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter a list of matches to only contain spans where the start token is followed by a new line.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of match tuples (match_id, start, end) that meet the filter criteria.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span> <span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">is_end_line</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newline_pattern</span><span class="p">)</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Sectionizer.input_span_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_span_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The input source of entities for the component. Must be either "ents" corresponding to doc.ents or "group" for
a spaCy span group.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input type, "ents" or "group".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Sectionizer.rules" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rules</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets list of rules associated with the Sectionizer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="medspacy.section_detection.section_rule.SectionRule" href="../../../#medspacy.section_detection.section_rule.SectionRule">SectionRule</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of SectionRules associated with the Sectionizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Sectionizer.section_categories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">section_categories</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Gets a list of categories used in the Sectionizer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Set">Set</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of all section categories available to the Sectionizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="medspacy.section_detection.Sectionizer.span_group_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">span_group_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>The name of the span group used by this component. If <code>input_type</code> is "group", calling this component will
use spans in the span group with this name.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The span group name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Call the Sectionizer on a spaCy doc. Sectionizer will identify sections using provided rules, then evaluate any
section hierarchy as needed, create section spans, and modify attributes on existing spans based on the sections
the entities spans in.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>doc</code>
            </td>
            <td>
                  <code><span title="spacy.tokens.Doc">Doc</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Doc to process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="spacy.tokens.Doc">Doc</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The processed spaCy Doc.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Call the Sectionizer on a spaCy doc. Sectionizer will identify sections using provided rules, then evaluate any</span>
<span class="sd">    section hierarchy as needed, create section spans, and modify attributes on existing spans based on the sections</span>
<span class="sd">    the entities spans in.</span>

<span class="sd">    Args:</span>
<span class="sd">        doc: The Doc to process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The processed spaCy Doc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_start_line</span><span class="p">:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_start_lines</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_end_line</span><span class="p">:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_end_lines</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_parent_sections</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>

    <span class="c1"># If this has already been processed by the sectionizer, reset the sections</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># if there were no matches, return the doc as one section</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Section</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">doc</span>

    <span class="n">section_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># if the first match does not begin at token 0, handle the first section</span>
    <span class="n">first_match</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">first_match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Section</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">first_match</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># handle section spans</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">matches</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">parent_idx</span><span class="p">)</span> <span class="o">=</span> <span class="n">match</span>
            <span class="k">if</span> <span class="n">parent_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">section_list</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># IDEs will warn here about match shape disagreeing w/ type hinting, but this if is only used if</span>
            <span class="c1"># parent sections were never set, so parent_idx does not exist</span>
            <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="o">=</span> <span class="n">match</span>

        <span class="c1"># Make section header its own sentence</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_sentence_boundary</span><span class="p">:</span>
            <span class="c1"># Section headers should be considered the start of a sentence</span>
            <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Text following the header should also be considered a new sentence</span>
            <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
                <span class="n">doc</span><span class="p">[</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">rule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="n">match_id</span><span class="p">]]</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">category</span>
        <span class="c1"># If this is the last match, it should include the rest of the doc</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If there is no scope limitation, go until the end of the doc</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If the rule has a max_scope, use that as a precedence</span>
                <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

                <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">scope_end</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="c1"># Otherwise, go until the next section header</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">next_match</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">next_match</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">next_match</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">next_start</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="n">rule</span><span class="o">.</span><span class="n">max_scope</span><span class="p">,</span> <span class="n">next_start</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">scope_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span><span class="p">,</span> <span class="n">next_start</span><span class="p">)</span>
                <span class="n">section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Section</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">scope_end</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rule</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">section_list</span><span class="p">:</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">section_span</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">section</span>

    <span class="c1"># If it is specified to add assertion attributes,</span>
    <span class="c1"># iterate through the entities in doc and add them</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ents&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_assertion_attributes</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_assertion_attributes</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;medspacy_sectionizer&#39;</span><span class="p">,</span> <span class="n">rules</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">language_code</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="n">max_section_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phrase_matcher_attr</span><span class="o">=</span><span class="s1">&#39;LOWER&#39;</span><span class="p">,</span> <span class="n">require_start_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">require_end_line</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline_pattern</span><span class="o">=</span><span class="s1">&#39;[</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">r]+[</span><span class="se">\\</span><span class="s1">s]*$&#39;</span><span class="p">,</span> <span class="n">input_span_type</span><span class="o">=</span><span class="s1">&#39;ents&#39;</span><span class="p">,</span> <span class="n">span_group_name</span><span class="o">=</span><span class="s1">&#39;medspacy_spans&#39;</span><span class="p">,</span> <span class="n">span_attrs</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">apply_sentence_boundary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <pre><code>   Create a new Sectionizer component.

   Args:
       nlp: A SpaCy Language object.
       name: The name of the component.
       rules: The rules to load. Default is "default", loads rules packaged with medspaCy that are derived from
           SecTag, MIMIC-III, and practical refinement at the US Department of Veterans Affairs. If None, no rules
           are loaded. Otherwise, must be a path to a json file containing rules. Add SectionRules directly through
           `Sectionizer.add`.
       language_code: Language code to use (ISO code) as a default for loading resources.  See documentation
           and also the /resources directory to see which resources might be available in each language.
           Default is "en" for English.
       max_section_length: Optional argument specifying the maximum number of tokens following a section header
           which can be included in a section body. This can be useful if you think your section rules are
           incomplete and want to prevent sections from running too long in the note. Default is None, meaning that
           the scope of a section will be until either the next section header or the end of the document.
       phrase_matcher_attr: The token attribute to use for PhraseMatcher for rules where `pattern` is None. Default
           is 'LOWER'.
       require_start_line: Optionally require a section header to start on a new line. Default False.
       require_end_line: Optionally require a section header to end with a new line. Default False.
       newline_pattern: Regular expression to match the new line either preceding or following a header
           if either require_start_line or require_end_line are True. Default is r"[
</code></pre>
<p>]+[\s]*$"
           span_attrs: The optional span attributes to modify. Default option "default" uses attributes in
               <code>DEFAULT_ATTRIBUTES</code>. If a dictionary of custom attributes, format is a dictionary mapping section
               categories to a dictionary containing the attribute name and the value to set the attribute to when a
               span is contained in a section of that category. Custom attributes must be assigned with
               <code>Span.set_extension</code> before creating the Sectionizer. If None, sectionizer will not modify span
               attributes.
           input_span_type: "ents" or "group". Where to look for spans when modifying attributes of spans
               contained in a section if <code>span_attrs</code> is not None. "ents" will modify attributes of spans in doc.ents.
               "group" will modify attributes of spans in the span group specified by <code>span_group_name</code>.
           span_group_name: The name of the span group used when <code>input_span_type</code> is "group". Default is
               "medspacy_spans".
           apply_sentence_boundary: Optionally end sentence before and after section header boundary. This ensures
               the section header is considered its own sentence.</p>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_sectionizer&quot;</span><span class="p">,</span>
    <span class="n">rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">language_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
    <span class="n">max_section_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phrase_matcher_attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;LOWER&quot;</span><span class="p">,</span>
    <span class="n">require_start_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">require_end_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">newline_pattern</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[\n\r]+[\s]*$&quot;</span><span class="p">,</span>
    <span class="n">input_span_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ents&quot;</span><span class="p">,</span>
    <span class="n">span_group_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;medspacy_spans&quot;</span><span class="p">,</span>
    <span class="n">span_attrs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="kc">None</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">apply_sentence_boundary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new Sectionizer component.</span>

<span class="sd">    Args:</span>
<span class="sd">        nlp: A SpaCy Language object.</span>
<span class="sd">        name: The name of the component.</span>
<span class="sd">        rules: The rules to load. Default is &quot;default&quot;, loads rules packaged with medspaCy that are derived from</span>
<span class="sd">            SecTag, MIMIC-III, and practical refinement at the US Department of Veterans Affairs. If None, no rules</span>
<span class="sd">            are loaded. Otherwise, must be a path to a json file containing rules. Add SectionRules directly through</span>
<span class="sd">            `Sectionizer.add`.</span>
<span class="sd">        language_code: Language code to use (ISO code) as a default for loading resources.  See documentation</span>
<span class="sd">            and also the /resources directory to see which resources might be available in each language.</span>
<span class="sd">            Default is &quot;en&quot; for English.</span>
<span class="sd">        max_section_length: Optional argument specifying the maximum number of tokens following a section header</span>
<span class="sd">            which can be included in a section body. This can be useful if you think your section rules are</span>
<span class="sd">            incomplete and want to prevent sections from running too long in the note. Default is None, meaning that</span>
<span class="sd">            the scope of a section will be until either the next section header or the end of the document.</span>
<span class="sd">        phrase_matcher_attr: The token attribute to use for PhraseMatcher for rules where `pattern` is None. Default</span>
<span class="sd">            is &#39;LOWER&#39;.</span>
<span class="sd">        require_start_line: Optionally require a section header to start on a new line. Default False.</span>
<span class="sd">        require_end_line: Optionally require a section header to end with a new line. Default False.</span>
<span class="sd">        newline_pattern: Regular expression to match the new line either preceding or following a header</span>
<span class="sd">            if either require_start_line or require_end_line are True. Default is r&quot;[\n\r]+[\s]*$&quot;</span>
<span class="sd">        span_attrs: The optional span attributes to modify. Default option &quot;default&quot; uses attributes in</span>
<span class="sd">            `DEFAULT_ATTRIBUTES`. If a dictionary of custom attributes, format is a dictionary mapping section</span>
<span class="sd">            categories to a dictionary containing the attribute name and the value to set the attribute to when a</span>
<span class="sd">            span is contained in a section of that category. Custom attributes must be assigned with</span>
<span class="sd">            `Span.set_extension` before creating the Sectionizer. If None, sectionizer will not modify span</span>
<span class="sd">            attributes.</span>
<span class="sd">        input_span_type: &quot;ents&quot; or &quot;group&quot;. Where to look for spans when modifying attributes of spans</span>
<span class="sd">            contained in a section if `span_attrs` is not None. &quot;ents&quot; will modify attributes of spans in doc.ents.</span>
<span class="sd">            &quot;group&quot; will modify attributes of spans in the span group specified by `span_group_name`.</span>
<span class="sd">        span_group_name: The name of the span group used when `input_span_type` is &quot;group&quot;. Default is</span>
<span class="sd">            &quot;medspacy_spans&quot;.</span>
<span class="sd">        apply_sentence_boundary: Optionally end sentence before and after section header boundary. This ensures</span>
<span class="sd">            the section header is considered its own sentence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_section_length</span> <span class="o">=</span> <span class="n">max_section_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">require_start_line</span> <span class="o">=</span> <span class="n">require_start_line</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">require_end_line</span> <span class="o">=</span> <span class="n">require_end_line</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newline_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">newline_pattern</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_span_type</span> <span class="o">=</span> <span class="n">input_span_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_span_group_name</span> <span class="o">=</span> <span class="n">span_group_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_apply_sentence_boundary</span> <span class="o">=</span> <span class="n">apply_sentence_boundary</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span> <span class="o">=</span> <span class="n">MedspacyMatcher</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">phrase_matcher_attr</span><span class="o">=</span><span class="n">phrase_matcher_attr</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s2">&quot;resources&quot;</span><span class="p">,</span>
        <span class="n">language_code</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
        <span class="s2">&quot;section_patterns.json&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">rule_path</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">rules</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="n">rule_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_RULES_FILEPATH</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rule_path</span> <span class="o">=</span> <span class="n">rules</span>

    <span class="k">if</span> <span class="n">rule_path</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">SectionRule</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">rule_path</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">span_attrs</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span> <span class="o">=</span> <span class="n">DEFAULT_ATTRS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_default_attributes</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">span_attrs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">attr_dict</span> <span class="ow">in</span> <span class="n">span_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Custom extension </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2"> has not been set. Please ensure Span.set_extension is &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;called for your pipeline&#39;s custom extensions.&quot;</span>
                    <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span> <span class="o">=</span> <span class="n">span_attrs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds SectionRules to the Sectionizer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rules</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single SectionRule or a collection of SectionRules to add to the Sectionizer.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds SectionRules to the Sectionizer.</span>

<span class="sd">    Args:</span>
<span class="sd">        rules: A single SectionRule or a collection of SectionRules to add to the Sectionizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">SectionRule</span><span class="p">):</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rules</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">SectionRule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Rules must be type SectionRule, not&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">rule</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">category</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">parents</span>
        <span class="n">parent_required</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">parent_required</span>
        <span class="k">if</span> <span class="n">parents</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Duplicate section title </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">. Merging parents. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;If this is not intended, please specify distinct titles.&quot;</span><span class="p">,</span>
                    <span class="ne">RuntimeWarning</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">parents</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">parent_required</span>
        <span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Duplicate section title </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> has different parent_required option. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Setting parent_required to False.&quot;</span><span class="p">,</span>
                <span class="ne">RuntimeWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_required</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.filter_end_lines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_end_lines</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Filter a list of matches to only contain spans where the start token is followed by a new line.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of match tuples (match_id, start, end) that meet the filter criteria.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_end_lines</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter a list of matches to only contain spans where the start token is followed by a new line.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of match tuples (match_id, start, end) that meet the filter criteria.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span> <span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">is_end_line</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newline_pattern</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.filter_start_lines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_start_lines</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Filter a list of matches to only contain spans where the start token is the beginning of a new line.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of match tuples (match_id, start, end) that meet the filter criteria.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_start_lines</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter a list of matches to only contain spans where the start token is the beginning of a new line.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of match tuples (match_id, start, end) that meet the filter criteria.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span> <span class="k">if</span> <span class="n">util</span><span class="o">.</span><span class="n">is_start_line</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">doc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newline_pattern</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.register_default_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_default_attributes</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Register the default values for the Span attributes defined in <code>DEFAULT_ATTRIBUTES</code>.</p>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_default_attributes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register the default values for the Span attributes defined in `DEFAULT_ATTRIBUTES`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;is_negated&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_uncertain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_historical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_hypothetical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_family&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Extension already set</span>
            <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.set_assertion_attributes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_assertion_attributes</span><span class="p">(</span><span class="n">spans</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add Span-level attributes to entities based on which section they occur in.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spans</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="spacy.tokens.Span">Span</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the spans to modify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_assertion_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spans</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Span</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add Span-level attributes to entities based on which section they occur in.</span>

<span class="sd">    Args:</span>
<span class="sd">        spans: the spans to modify.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">spans</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span>
            <span class="ow">and</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span>
        <span class="p">):</span>
            <span class="n">attr_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertion_attributes_mapping</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">category</span><span class="p">]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">attr_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="medspacy.section_detection.Sectionizer.set_parent_sections" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_parent_sections</span><span class="p">(</span><span class="n">sections</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Determine the legal parent-child section relationships from the list
of in-order sections of a document and the possible parents of each
section as specified during direction creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sections</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of spacy match tuples found in the doc</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of tuples (match_id, start, end, parent_idx) where the first three indices are the same as the input</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>and the added parent_idx represents the index in the list that corresponds to the parent section. Might be a</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int, int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>smaller list than the input due to pruning with <code>parent_required</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>medspacy/section_detection/sectionizer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_parent_sections</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the legal parent-child section relationships from the list</span>
<span class="sd">    of in-order sections of a document and the possible parents of each</span>
<span class="sd">    section as specified during direction creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        sections: a list of spacy match tuples found in the doc</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of tuples (match_id, start, end, parent_idx) where the first three indices are the same as the input</span>
<span class="sd">        and the added parent_idx represents the index in the list that corresponds to the parent section. Might be a</span>
<span class="sd">        smaller list than the input due to pruning with `parent_required`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sections_final</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">removed_sections</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sections</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="n">match_id</span><span class="p">]]</span><span class="o">.</span><span class="n">category</span>
        <span class="n">required</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_required</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">i_a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">removed_sections</span>  <span class="c1"># adjusted index for removed values</span>
        <span class="k">if</span> <span class="n">required</span> <span class="ow">and</span> <span class="n">i_a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">removed_sections</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">i_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sections_final</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_sections</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">identified_parent</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">:</span>
                <span class="c1"># go backwards through the section &quot;tree&quot; until you hit a root or the start of the list</span>
                <span class="n">candidate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="n">sections_final</span><span class="p">[</span><span class="n">i_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                <span class="n">candidates_parent_idx</span> <span class="o">=</span> <span class="n">sections_final</span><span class="p">[</span><span class="n">i_a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">candidates_parent_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">candidates_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span>
                            <span class="n">sections_final</span><span class="p">[</span><span class="n">candidates_parent_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="p">]</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">candidates_parent</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">candidate_i</span> <span class="o">=</span> <span class="n">i_a</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">candidate</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">candidate</span> <span class="o">==</span> <span class="n">parent</span><span class="p">:</span>
                        <span class="n">identified_parent</span> <span class="o">=</span> <span class="n">candidate_i</span>
                        <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># if you are at the end of the list... no parent</span>
                        <span class="k">if</span> <span class="n">candidate_i</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="k">continue</span>
                        <span class="c1"># if the current candidate has no parent... no parent exists</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">candidates_parent</span><span class="p">:</span>
                            <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="k">continue</span>
                        <span class="c1"># otherwise get the previous item in the list</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span>
                                <span class="n">sections_final</span><span class="p">[</span><span class="n">candidate_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                            <span class="p">]</span>
                        <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                        <span class="n">temp_parent_idx</span> <span class="o">=</span> <span class="n">sections_final</span><span class="p">[</span><span class="n">candidate_i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">temp_parent_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">temp_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matcher</span><span class="o">.</span><span class="n">rule_map</span><span class="p">[</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span>
                                    <span class="n">sections_final</span><span class="p">[</span><span class="n">temp_parent_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                <span class="p">]</span>
                            <span class="p">]</span><span class="o">.</span><span class="n">category</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">temp_parent</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="c1"># if the previous item is the parent of the current item</span>
                        <span class="c1"># OR if the previous item is a sibling of the current item</span>
                        <span class="c1"># continue to search</span>
                        <span class="k">if</span> <span class="p">(</span>
                            <span class="n">temp</span> <span class="o">==</span> <span class="n">candidates_parent</span>
                            <span class="ow">or</span> <span class="n">temp_parent</span> <span class="o">==</span> <span class="n">candidates_parent</span>
                        <span class="p">):</span>
                            <span class="n">candidate</span> <span class="o">=</span> <span class="n">temp</span>
                            <span class="n">candidates_parent</span> <span class="o">=</span> <span class="n">temp_parent</span>
                            <span class="n">candidate_i</span> <span class="o">-=</span> <span class="mi">1</span>
                        <span class="c1"># otherwise, there is no further tree traversal</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">candidate</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># if a parent is required, then add</span>
            <span class="k">if</span> <span class="n">identified_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">required</span><span class="p">:</span>
                <span class="c1"># if the parent is identified, add section</span>
                <span class="c1"># if the parent is not required, add section</span>
                <span class="c1"># if parent is not identified and required, do not add the section</span>
                <span class="n">sections_final</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">identified_parent</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">removed_sections</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">sections_final</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>